TODO: crib from https://martinfowler.com/books/refactoring.html